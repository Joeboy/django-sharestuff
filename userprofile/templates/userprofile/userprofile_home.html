{% extends 'base.html' %}

{% block extrahead %}{{block.super}}
    <link href="http://www.google.com/uds/css/gsearch.css" type="text/css" rel="stylesheet" />
    <link rel="stylesheet" href="http://www.google.com/uds/solutions/localsearch/gmlocalsearch.css" />
    <script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAA0okLrKZhiNabzBlBE2rJHRQRB3d2m0eE07bem--pb7XcM7LibBS3sJZUsLLOaucwIRuf8Q4305bVSw"></script> 

    <script src="/media/js/location_widget.js" type="text/javascript"></script>

{% endblock %}

{% block content %}
<h2>{{user.username}}'s profile</h2>

{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

{% with user.get_profile.offer_set.live.count as live_offer_count %}
    <p>You are currently offering {{ live_offer_count }} item{{ live_offer_count|pluralize }}. <a href="{% url my_offers %}">View/edit your offers</a>.</p>
{% endwith %}

<p>View your <a href="{% url user_details user.username %}">public profile</a>.</p>

<h4>Contact details</h4>

{% if userprofile_form.errors %}
    {{ userprofile_form.errors.as_ul }}
{% endif %}

<form action="" method="post" id="userprofile_form">{% csrf_token %}
  <fieldset>
    <p><label for="id_email">Email:</label>{{ userprofile_form.email }}</p>
    <p><label for="id_phone_number">Phone number:</label>{{ userprofile_form.phone_number }}</p>

    <h4>Location:</h4>
        <p id="latlon_text">On most web browsers you should see a map below. If your browser doesn't show you a map, you'll have to find and enter your latitude and longitude manually below, as decimals.</p>
        <p><label for="id_latitude">Latitude:</label>{{userprofile_form.latitude}}</p>
        <p><label for="id_longitude">Longitude:</label>{{userprofile_form.longitude}}</p>

  </fieldset>

<input type="submit" value="Update">
</form>
{% endblock %}
